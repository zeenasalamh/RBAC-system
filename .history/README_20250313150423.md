Laravel Role-based Access Control (RBAC) API
A RESTful API for managing dynamic role-based access control with record-level permissions and comprehensive audit logging.
Features

Role & Permission Management: Create, read, update, and delete roles and permissions via API
Record-level Permissions: Control access at the individual record level, not just endpoint level
Dynamic Role Assignment: Users can have multiple roles with immediate permission effect
Audit Trail: Track all permission and role changes with before/after states

Setup Instructions

Clone the repository:
bashCopygit clone [repository-url]
cd rbac-system

Install dependencies:
bashCopycomposer install

Configure your environment:
bashCopycp .env.example .env
php artisan key:generate

Configure database in .env file:
CopyDB_CONNECTION=mysql
DB_HOST=127.0.0.1
DB_PORT=3306
DB_DATABASE=rbac
DB_USERNAME=root
DB_PASSWORD=

Run migrations and seed the database:
bashCopyphp artisan migrate --seed

Start the server:
bashCopyphp artisan serve


API Documentation
Authentication
CopyPOST /api/login
Request:
jsonCopy{
  "email": "admin@example.com",
  "password": "password"
}
Response:
jsonCopy{
  "token": "1|your-auth-token"
}
Use this token in the Authorization header for subsequent requests:
CopyAuthorization: Bearer 1|your-auth-token
Roles
CopyGET /api/roles                - List all roles
POST /api/roles               - Create a new role
GET /api/roles/{id}           - Get a specific role
PUT /api/roles/{id}           - Update a role
DELETE /api/roles/{id}        - Delete a role
Creating roles example:
jsonCopy{
  "name": "Editor",
  "description": "Can edit content",
  "permissions": [
    {"id": 1},
    {"id": 5, "record_conditions": "{\"allowed_ids\":[1,2,3]}"}
  ]
}
Permissions
CopyGET /api/permissions                - List all permissions
POST /api/permissions               - Create a new permission
GET /api/permissions/{id}           - Get a specific permission
PUT /api/permissions/{id}           - Update a permission
DELETE /api/permissions/{id}        - Delete a permission
Creating permissions example:
jsonCopy{
  "name": "Edit Posts",
  "description": "Can edit posts",
  "resource": "posts",
  "action": "edit",
  "record_level": true
}
User Roles
CopyGET /api/users/{user}/roles             - Get user's roles
POST /api/users/{user}/roles            - Assign roles to user
DELETE /api/users/{user}/roles/{role}   - Remove role from user
Assigning roles example:
jsonCopy{
  "roles": [1, 2, 3]
}
Audit Logs
CopyGET /api/audit-logs                 - List audit logs
GET /api/audit-logs/{id}            - Get specific audit log
Architecture
The system implements:

Models:

User: Has many roles through pivot table
Role: Has many permissions through pivot table
Permission: Can be endpoint or record level
AuditLog: Records all changes


Middleware:

CheckPermission: Validates user permissions for each request


Services:

AuditService: Logs all permission/role changes



Testing
Default admin credentials:

Email: admin@example.com
Password: password

Assumptions

The system uses Laravel Sanctum for API authentication
Record-level permissions use a JSON structure for conditions
All changes take immediate effect without re-authentication
The audit system logs both the actor and the changes made

Security Measures

API rate limiting
Comprehensive validation
Token-based authentication
Permission checks on all endpoints